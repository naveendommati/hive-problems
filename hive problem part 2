
1 ) Suppose, I have a CSV file – ‘sample.csv’ present in ‘/temp’ directory with the following entries:
id first_name last_name email gender ip_address
How will you consume this CSV file into the Hive warehouse using built-in SerDe?
answer:---
CREATE EXTERNAL TABLE sample(id int, first_name string, last_name string, email string, gender string, ip_address string) 
ROW FORMAT SERDE ‘org.apache.hadoop.hive.serde2.OpenCSVSerde’ 
STORED AS TEXTFILE LOCATION ‘/temp’;

2) Suppose, I have a lot of small CSV files present in the input directory in HDFS and I want to create a single Hive table corresponding to these files. The data in these files are in the format: {id, name, e-mail, country}. Now, as we know, Hadoop performance degrades when we use lots of small files.
So, how will you solve this problem where we want to create a single Hive table for lots of small files without degrading the performance of the system?
answer:-- 
### first we  will create temporary table in hive and load data into temporary table
CREATE TABLE temporary(id INT, name STRING, e-mail STRING, country STRING)
ROW FORMAT DELIMITED 
FIELDS TERMINATED BY ‘,’ 
STORED AS TEXTFILE;
load data local inpath 'file///confige/bigdata/ good'INTO TABLE temporary;

## now we will create a permanant table where all files need to move.
CREATE TABLE sample(id INT, name STRING, e-mail STRING, country STRING)
ROW FORMAT DELIMITED  
FIELDS TERMINATED BY ‘,’
STORED AS SEQUENCEFILE;
insert Overwrite table sample select * from temporary;

##all data will be transfered from old table to permenant table with out losing of data.

3) How can you add a new partition for the month December in the above partitioned table?

